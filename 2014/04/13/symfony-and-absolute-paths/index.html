<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Symfony & Absolute Paths - Stan Lemon</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="My love affair with Symfony 2 has hit a rocky spot.">
  <meta name="keywords" content="coding, PHP, Symfony, Bamboo CI">
  <meta name="author" content="Stan Lemon">
  <meta name="theme-color" content="#FEAE0F"/>
  <link rel="canonical" href="https://stanlemon.com/2014/04/13/symfony-and-absolute-paths/">
  <link rel="alternate" type="application/rss+xml" title="Stan Lemon" href="https://stanlemon.com/feed.xml" />

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://stanlemon.com/2014/04/13/symfony-and-absolute-paths/">
  <meta property="og:title" content="Symfony & Absolute Paths">
  <meta property="og:description" content="My love affair with Symfony 2 has hit a rocky spot.">
  <meta property="og:image" content="https://stanlemon.com/assets/lemon-with-leaves@2x.png">
  <meta property="og:site_name" content="Stan Lemon">
  <meta property="article:published_time" content="2014-04-13T17:19:00+0000">
  <meta property="article:author" content="Stan Lemon">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://stanlemon.com/2014/04/13/symfony-and-absolute-paths/">
  <meta name="twitter:title" content="Symfony & Absolute Paths">
  <meta name="twitter:description" content="My love affair with Symfony 2 has hit a rocky spot.">
  <meta name="twitter:image" content="https://stanlemon.com/assets/lemon-with-leaves@2x.png">

  <link rel="preload" as="font" href="/assets/fonts/oswald.woff" type="font/woff2" crossorigin="anonymous">

  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">

  <link rel="stylesheet" href="/css/main.css">

  <!-- Structured Data / JSON-LD -->
  
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Symfony & Absolute Paths",
    "author": {
      "@type": "Person",
      "name": "Stan Lemon"
    },
    "datePublished": "2014-04-13T17:19:00+0000",
    "description": "My love affair with Symfony 2 has hit a rocky spot.",
    "image": "https://stanlemon.com/assets/lemon-with-leaves@2x.png",
    "url": "https://stanlemon.com/2014/04/13/symfony-and-absolute-paths/",
    "publisher": {
      "@type": "Person",
      "name": "Stan Lemon"
    }
  }
  </script>
  

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LRTQMGFLV3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LRTQMGFLV3');
  </script>
</head>
<body>

<div class="container" role="main">
  <div class="content">
    <a href="https://stanlemon.com/">
      <img src="https://stanlemon.com/assets/lemon-with-leaves@2x.png" class="post-img" alt="Stan Lemon's logo - a lemon with leaves" />
    </a>

    
<article>
  <div class="columns is-vbottom">
    <div>
      <h2 class="article-title">
        <a href="">Symfony & Absolute Paths</a>
      </h2>
    </div>
    <h4 class="article-date">Apr 13, 2014</h4>
  </div>

  <hr>

  <p>My love affair with <a href="http://symfony.com">Symfony</a> 2 has hit a rocky spot. I have an atomic deployment system for a Symfony 2 app that I've been working on.  Basically it works like this... The app gets built on my CI server, <a href="https://www.atlassian.com/software/bamboo">Bamboo</a>. That build results in an artifact, a tarball of the entire application.  This tarball is intended to represent the final product, meaning tests have all been run - they passed - and any compilation steps have been executed.  But I've got a problem.  It comes when I try to warm the cache or more generally if I run any Symfony console command on the build system before the artifact is made. This includes things like installing <a href="http://symfony.com/doc/current/cookbook/assetic/index.html">Assetic</a> dependencies.  To work around my problem I've been making sure my 'cache' folder is empty before I build the tarball.  I wind up crossing my fingers on the deploy step and trusting that things will work themselves out when the cache is warmed and the container is compiled on the application server.  This is a horrible solute.  It's one I'm forced to deal with because of the way Symfony 2 dumps it's dependency injection container.  The container dump compiles references to <em>%kernel.root_dir%</em> which is an absolute path to the application root. That path is different on my CI server than it is on my production application server. If I compile the container on the CI server I wind up with a dump file that has the wrong absolute paths, resulting in a non-function app.</p>
<p>Some may want to question not doing the build on the application server if this is a problem. That may work for some people, but I think it's wrong to assume it's going to be possible in every deployment scenario.  There are simply a lot of regulated industries where building on the application server simply is not going to pass an audit. In my experience both in the PCI and Hippa worlds this simply wouldn't have worked.  You may disagree, but the reality is when you get into sorts of regulated environments you are playing by someone else's rules, even if they're silly rules. Furthermore, this solution does not scale.  It works for small clusters, but there's a point at which it simply is too long to roll that sort of deployment process out across a datacenter.  I've spent a fair amount of time solving software problems in these sort of regulated environments, so now I am admittedly wired to consider such things even when they're not being mandated by a regulatory body.  My build system involves Bamboo and <a href="http://www.ansible.com/">Ansible</a>.  Out of this system a singular artifact of the application is produced for deployment. It's a clean system and I can pull the artifact down from the CI server at any point and work with the exact distribution that will hit my application server at any time. Well, identical so long as the cache is not built. Here lies my beef with the way Symfony works.</p>
<p>As I mentioned, this has been a bit of a pain with Assetic.  Until recently I was able to avoid it for the most part. Assetic can be a great tool, especially during development, but much of it can be circumvented with more front end centric tools like Grunt. Recently though I started playing around with the <a href="https://github.com/Spea/SpBowerBundle">SpBowerBundle</a> to manage front end assets and hit this problem again.  In principle I really like what SpBowerBundle brings to the table.  It's an awesome union of front end and back end dependency management into a nice clean integrated system.  However, this time I just couldn't make it work.  This is no fault of the Bundle's, as I eluded to earlier, I consider this a flaw in the way the container is compiled.</p>
<p>In general I am a huge fan of Symfony 2. I love the design and architecture of the system, and the flexibility to build a truly componetized app is unique in the PHP-stratosphere right now. This doesn't seem to me like it should be an issue, yet it is. It also seems to me like more people should be wrestling with this, but I'm not finding the blog articles on it or any workarounds for that matter.  Truthfully I suspect the problem could be resolved by delegating the string replacement of <em>%kernel.root_dir%</em> to a method call, like <em>getRootDir()</em> which could then return the magic constant <em>__DIR__</em> and we could use absolutely paths without having to hardcode them.</p>


  

  <hr>
</article>


<p class="text-center">
  <em><a href="https://eepurl.com/gvEkEL">Do you want to get new posts from my website directly in your inbox? Subscribe today!</a></em>
</p>

  </div>
</div>

<footer>
  <div class="text-center">
    <ul>
      <li>
        <a href="https://github.com/stanlemon" rel="noopener" target="_blank" aria-label="You can find some of my coding projects on GitHub" class="social-github">
          <i class="fa-brands fa-github fa-2x" title="GitHub"></i>
        </a>
      </li>
      <li>
        <a href="https://linkedin.com/in/stanlemon" rel="noopener" target="_blank" aria-label="You can find about me professionally on LinkedIn" class="social-linkedin">
          <i class="fa-brands fa-linkedin fa-2x" title="LinkedIn"></i>
        </a>
      </li>
      <li>
        <a href="https://instagram.com/stanlemon" rel="noopener" target="_blank" aria-label="Follow me on Instagram" class="social-instagram">
          <i class="fa-brands fa-instagram fa-2x" title="Instagram"></i>
        </a>
      </li>
      <li>
        <a href="https://threads.net/@stanlemon" rel="noopener" target="_blank" aria-label="Follow me on Threads" class="social-threads">
          <i class="fa-brands fa-threads fa-2x" title="Threads"></i>
        </a>
      </li>
      <li>
        <a href="https://www.youtube.com/@stanlemon" rel="noopener" target="_blank" aria-label="Watch my videos on YouTube" class="social-youtube">
          <i class="fa-brands fa-youtube fa-2x" title="YouTube"></i>
        </a>
      </li>
      <li>
        <a href="https://stanlemon.com/feed.xml" aria-label="Subscribe via RSS" class="social-rss">
          <i class="fa-solid fa-square-rss fa-2x" title="Subscribe via RSS"></i>
        </a>
      </li>
    </ul>
    <p class="copyright">&copy; 2025 Stan Lemon. All rights reserved.</p>
  </div>
</footer>
